import{_ as f,c as p,a as o,b as c,w as a,v as m,d,t as y,h as N,o as i,i as w,g as h}from"./index-CkUboUl1.js";const x={name:"LoginForm",data(){return{email:"",password:"",error:""}},methods:{async login(){if(this.error="",!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.email)){this.error="Email invalide.";return}if(!this.password||this.password.length<4){this.error="Mot de passe requis.";return}try{const e=await fetch("/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:this.email,password:this.password})});if(!e.ok){const u=await e.json();this.error=u.message||"Erreur de connexion";return}const l=await e.json();this.$emit("login",l)}catch{this.error="Erreur réseau ou serveur."}}}},S={class:"auth-container"},k={key:0,class:"error"};function V(s,e,l,u,r,n){return i(),p("div",S,[e[6]||(e[6]=o("h2",null,"Connexion",-1)),o("form",{onSubmit:e[2]||(e[2]=d((...t)=>n.login&&n.login(...t),["prevent"]))},[a(o("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>r.email=t),type:"email",placeholder:"Email",required:"",autocomplete:"email"},null,512),[[m,r.email]]),a(o("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>r.password=t),type:"password",placeholder:"Mot de passe",required:"",autocomplete:"current-password"},null,512),[[m,r.password]]),e[4]||(e[4]=o("button",{type:"submit"},"Se connecter",-1))],32),r.error?(i(),p("p",k,y(r.error),1)):c("",!0),o("p",null,[e[5]||(e[5]=N("Pas de compte ? ",-1)),o("a",{href:"#",onClick:e[3]||(e[3]=d(t=>s.$emit("switchMode","register"),["prevent"]))},"Inscription")])])}const b=f(x,[["render",V]]),R={name:"RegisterForm",data(){return{firstName:"",lastName:"",email:"",password:"",error:""}},methods:{async register(){this.error="";const s=/^[\wÀ-ÿ' -]{2,30}$/;if(!s.test(this.firstName)||!s.test(this.lastName)){this.error="Nom ou prénom invalide.";return}if(this.password.length<8){this.error="Le mot de passe doit faire au moins 8 caractères.";return}try{const e=await fetch("/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firstName:this.firstName,lastName:this.lastName,email:this.email,password:this.password})});if(!e.ok){const l=await e.json();this.error=l.message||"Erreur lors de l'inscription";return}this.$emit("register")}catch{this.error="Erreur réseau ou serveur."}}}},C={class:"auth-container"},L={key:0,class:"error"};function M(s,e,l,u,r,n){return i(),p("div",C,[e[8]||(e[8]=o("h2",null,"Inscription",-1)),o("form",{onSubmit:e[4]||(e[4]=d((...t)=>n.register&&n.register(...t),["prevent"]))},[a(o("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>r.firstName=t),type:"text",placeholder:"Prénom",required:"",pattern:"^[\\wÀ-ÿ' -]{2,30}$"},null,512),[[m,r.firstName]]),a(o("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>r.lastName=t),type:"text",placeholder:"Nom",required:"",pattern:"^[\\wÀ-ÿ' -]{2,30}$"},null,512),[[m,r.lastName]]),a(o("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>r.email=t),type:"email",placeholder:"Email",required:"",autocomplete:"email"},null,512),[[m,r.email]]),a(o("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>r.password=t),type:"password",placeholder:"Mot de passe (min 8 caractères)",required:"",minlength:"8",autocomplete:"new-password"},null,512),[[m,r.password]]),e[6]||(e[6]=o("button",{type:"submit"},"S'inscrire",-1))],32),r.error?(i(),p("p",L,y(r.error),1)):c("",!0),o("p",null,[e[7]||(e[7]=N("Déjà un compte ? ",-1)),o("a",{href:"#",onClick:e[5]||(e[5]=d(t=>s.$emit("switchMode","login"),["prevent"]))},"Connexion")])])}const E=f(R,[["render",M],["__scopeId","data-v-dc152c3e"]]),F={name:"AuthView",components:{LoginForm:b,RegisterForm:E},data(){return{mode:"login"}},methods:{onLogin(s){localStorage.setItem("user",JSON.stringify(s)),this.$router.push("/dashboard")},onRegister(s){alert("Inscription réussie ! Connectez-vous."),this.mode="login"}}};function q(s,e,l,u,r,n){const t=h("LoginForm"),v=h("RegisterForm");return i(),p("div",null,[r.mode==="login"?(i(),w(t,{key:0,onLogin:n.onLogin,onSwitchMode:e[0]||(e[0]=g=>r.mode=g)},null,8,["onLogin"])):(i(),w(v,{key:1,onRegister:n.onRegister,onSwitchMode:e[1]||(e[1]=g=>r.mode=g)},null,8,["onRegister"]))])}const T=f(F,[["render",q]]);export{T as default};
