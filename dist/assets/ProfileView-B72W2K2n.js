import{_ as p,c as l,a as t,b as f,w as a,v as n,d,t as N,o as u}from"./index-CkUboUl1.js";const c={name:"ProfileView",data(){return{firstName:"",lastName:"",email:"",error:"",success:!1}},methods:{async fetchProfile(){this.error="";try{const s=localStorage.getItem("token"),e=await fetch("/users/me",{headers:{Authorization:s?`Bearer ${s}`:""}});if(!e.ok){this.error="Erreur lors de la récupération du profil.";return}const i=await e.json();this.firstName=i.firstName,this.lastName=i.lastName,this.email=i.email}catch{this.error="Erreur réseau ou serveur."}},async updateProfile(){this.error="",this.success=!1;const s=/^[\wÀ-ÿ' -]{2,30}$/;if(!s.test(this.firstName)||!s.test(this.lastName)){this.error="Nom ou prénom invalide.";return}try{const e=localStorage.getItem("token");if(!(await fetch("/users/me",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:e?`Bearer ${e}`:""},body:JSON.stringify({firstName:this.firstName,lastName:this.lastName})})).ok){this.error="Erreur lors de la mise à jour.";return}this.success=!0}catch{this.error="Erreur réseau ou serveur."}}},mounted(){this.fetchProfile()}},h={class:"profile-container"},y={key:0,class:"success"},w={key:1,class:"error"};function k(s,e,i,P,r,m){return u(),l("div",h,[e[8]||(e[8]=t("h2",null,"Mon profil",-1)),t("form",{onSubmit:e[3]||(e[3]=d((...o)=>m.updateProfile&&m.updateProfile(...o),["prevent"]))},[e[4]||(e[4]=t("label",null,"Prénom :",-1)),a(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>r.firstName=o),type:"text",required:"",pattern:"^[\\wÀ-ÿ' -]{2,30}$"},null,512),[[n,r.firstName]]),e[5]||(e[5]=t("label",null,"Nom :",-1)),a(t("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>r.lastName=o),type:"text",required:"",pattern:"^[\\wÀ-ÿ' -]{2,30}$"},null,512),[[n,r.lastName]]),e[6]||(e[6]=t("label",null,"Email :",-1)),a(t("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>r.email=o),type:"email",required:"",disabled:""},null,512),[[n,r.email]]),e[7]||(e[7]=t("button",{type:"submit"},"Mettre à jour",-1))],32),r.success?(u(),l("p",y,"Profil mis à jour !")):f("",!0),r.error?(u(),l("p",w,N(r.error),1)):f("",!0)])}const v=p(c,[["render",k],["__scopeId","data-v-627564e5"]]);export{v as default};
